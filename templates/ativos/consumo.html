{% extends "base.html" %}
{% block title %}Histórico de Consumo — {{ ativo.nome }}{% endblock %}

{% block content %}
<div class="page">

  <!-- CABEÇALHO -->
  <div style="
    display:flex;
    justify-content:space-between;
    align-items:center;
    flex-wrap:wrap;
    gap:16px;
    margin-bottom:24px;
  ">
    <div>
      <h1>Histórico de Consumo</h1>
      <p class="muted">Ativo: {{ ativo.nome }}</p>
    </div>

    <a href="/ativos/{{ ativo.id }}/painel" class="btn-ghost">
      ← Voltar ao painel
    </a>
  </div>

  <!-- FILTRO -->
  <div style="
    background:rgba(255,255,255,0.04);
    border:1px solid rgba(255,255,255,0.08);
    border-radius:14px;
    padding:20px;
    margin-bottom:24px;
  ">
    <form method="get"
          style="display:flex;gap:16px;align-items:end;flex-wrap:wrap;">

      <div style="display:flex;flex-direction:column;gap:6px;">
        <label class="muted">Data inicial</label>
        <input type="date"
               name="inicio"
               value="{{ request.args.get('inicio','') }}">
      </div>

      <div style="display:flex;flex-direction:column;gap:6px;">
        <label class="muted">Data final</label>
        <input type="date"
               name="fim"
               value="{{ request.args.get('fim','') }}">
      </div>

      <button class="btn-primary" type="submit" style="height:42px;">
        Buscar
      </button>
    </form>
  </div>

  <!-- TABELA FULL WIDTH -->
  <div style="
    background:rgba(255,255,255,0.04);
    border:1px solid rgba(255,255,255,0.08);
    border-radius:14px;
    padding:0;
    overflow:hidden;
  ">
    <table class="table" style="width:100%;margin:0;">
      <thead>
        <tr>
          <th style="padding:16px;">Data</th>
          <th style="padding:16px;">Horas de motor</th>
          <th style="padding:16px;">Consumo médio (L/h)</th>
          <th style="padding:16px;">Consumo total (L)</th>
        </tr>
      </thead>
      <tbody>
        {% for r in registros %}
        <tr>
          <td style="padding:14px;">{{ r.data_referencia.strftime('%d/%m/%Y') }}</td>
          <td style="padding:14px;">{{ r.horas_motor }}</td>
          <td style="padding:14px;">{{ r.consumo_lph }}</td>
          <td style="padding:14px;">{{ r.consumo_total }}</td>
        </tr>
        {% else %}
        <tr>
          <td colspan="4" class="muted" style="padding:20px;text-align:center;">
            Nenhum registro encontrado para o período selecionado
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}
